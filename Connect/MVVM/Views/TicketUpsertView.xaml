<UserControl
    x:Class = "SAMS.Connect.MVVM.Views.TicketUpsertView"
    xmlns = "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x = "http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc = "http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d = "http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i = "http://schemas.microsoft.com/xaml/behaviors"
    xmlns:models = "clr-namespace:SAMS.Connect.MVVM.Models"
    xmlns:viewmodels = "clr-namespace:SAMS.Connect.MVVM.ViewModels"
    mc:Ignorable = "d"
    d:DataContext = "{d:DesignInstance viewmodels:TicketUpsertViewModel}"
    d:DesignHeight = "800"
    d:DesignWidth = "1252">

    <Grid
        Background = "{StaticResource Surface}">

        <Grid
            Margin = "24">
            <Grid.RowDefinitions>
                <RowDefinition
                    Height = "*" />
                <RowDefinition
                    Height = "24" />
                <RowDefinition
                    Height = "Auto" />
            </Grid.RowDefinitions>

            <Grid
                Grid.Row = "0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition
                        Width = "*" />
                    <ColumnDefinition
                        Width = "24" />
                    <ColumnDefinition
                        Width = "*" />
                </Grid.ColumnDefinitions>

                <Grid
                    Grid.Column = "0">
                    <Grid.RowDefinitions>
                        <RowDefinition
                            Height = "Auto" />
                        <RowDefinition
                            Height = "24" />
                        <RowDefinition
                            Height = "Auto" />
                        <RowDefinition
                            Height = "24" />
                        <RowDefinition
                            Height = "*" />
                    </Grid.RowDefinitions>

                    <StackPanel
                        Grid.Row = "0">
                        <Label
                            Content = "Location *" />
                        <TextBox
                            x:Name = "InputLocation"
                            Text = "{Binding Form.Entity.FaultLocation, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                            Style = "{StaticResource TbxStandard}" />
                        <Label
                            Content = "{Binding ElementName=InputLocation, Path=(Validation.Errors)[0].ErrorContent}"
                            Style = "{StaticResource LabError}"
                            d:IsHidden = "True" />
                    </StackPanel>

                    <StackPanel
                        Grid.Row = "2">
                        <Label
                            Content = "Category *" />
                        <ComboBox
                            x:Name = "InputCategory"
                            SelectedItem = "{Binding Form.Entity.FaultCategory, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                            ItemsSource = "{Binding DepartmentOptions}"
                            Style = "{StaticResource CbxStandard}" />
                        <Label
                            Content = "{Binding ElementName=InputCategory, Path=(Validation.Errors)[0].ErrorContent}"
                            Style = "{StaticResource LabError}"
                            d:IsHidden = "True" />
                    </StackPanel>

                    <Grid
                        Grid.Row = "4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width = "*" />
                            <ColumnDefinition
                                Width = "50" />
                        </Grid.ColumnDefinitions>

                        <Grid
                            Grid.Column = "0">
                            <Grid.RowDefinitions>
                                <RowDefinition
                                    Height = "Auto" />
                                <RowDefinition
                                    Height = "*" />
                            </Grid.RowDefinitions>
                            <Label
                                Grid.Row = "0"
                                Content = "Supporting Files" />
                            <ListView
                                x:Name = "AttachmentList"
                                Grid.Row = "1"
                                SelectionMode = "Single"
                                ItemsSource = "{Binding Form.Attachments}"
                                DisplayMemberPath = "FileName" />
                        </Grid>

                        <Grid
                            Grid.Column = "1">
                            <Grid.RowDefinitions>
                                <RowDefinition
                                    Height = "*" />
                                <RowDefinition
                                    Height = "Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Resources>
                                <Style
                                    TargetType = "{x:Type Button}">
                                    <Setter
                                        Property = "Width"
                                        Value = "80" />
                                    <Setter
                                        Property = "MaxHeight"
                                        Value = "Infinity" />
                                </Style>
                            </Grid.Resources>
                            <Button
                                Grid.Row = "0"
                                Content = "Add"
                                Command = "{Binding FileInsertCommand}"
                                VerticalAlignment="Stretch"
                                Margin="0,25,0,0"
                                Style = "{StaticResource BtnStandard}" />

                            <Button
                                Grid.Row = "1"
                                Content = "✕"
                                Command = "{Binding FileRemoveCommand}"
                                CommandParameter = "{Binding ElementName=AttachmentList, Path=SelectedItem}"
                                Style = "{StaticResource BtnStandard}" />
                        </Grid>
                    </Grid>
                </Grid>

                <Grid
                    Grid.Column = "2">
                    <Grid.RowDefinitions>
                        <RowDefinition
                            Height = "Auto" />
                        <RowDefinition
                            Height = "*" />
                    </Grid.RowDefinitions>
                    <Label
                        Grid.Row = "0"
                        Content = "Description of The Issue *" />
                    <RichTextBox
                        Grid.Row = "1"
                        VerticalScrollBarVisibility = "Visible"
                        x:Name = "InputDescription"
                        models:RichTextBoxHelper.DocumentText = "{Binding Form.Entity.FaultDescription, Mode=TwoWay, UpdateSourceTrigger=Explicit, NotifyOnValidationError=True}"
                        Style = "{StaticResource TbxRichText}">
                        <i:Interaction.Triggers>
                            <i:EventTrigger
                                EventName = "TextChanged">
                                <i:InvokeCommandAction
                                    Command = "{Binding UpdateDescriptionCommand}"
                                    CommandParameter = "{Binding ElementName=InputDescription}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </RichTextBox>
                    <Label
                        Grid.Row = "1"
                        VerticalAlignment = "Bottom"
                        Content = "{Binding ElementName=InputDescription, Path=(Validation.Errors)[0].ErrorContent}"
                        Style = "{StaticResource LabError}"
                        d:IsHidden = "True" />
                </Grid>
            </Grid>

            <Grid
                Grid.Row = "2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition
                        Width = "*" />
                    <ColumnDefinition
                        Width = "Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel
                    Grid.Column = "0"
                    Orientation = "Horizontal"
                    HorizontalAlignment = "Left">
                    <Label
                        Content = "{Binding Form.Entity.CompletedFieldsCount}" />
                    <Label
                        Content = "/" />
                    <Label
                        Content = "3" />
                    <Rectangle
                        Width = "6"
                        Fill = "Transparent" />
                    <Label
                        Content = "Completed" />
                </StackPanel>

                <StackPanel
                    Grid.Column = "1"
                    Orientation = "Horizontal"
                    HorizontalAlignment = "Right">
                    <Button
                        Content = "Cancel"
                        Command = "{Binding CancelFormCommand}"
                        Style = "{StaticResource BtnStandard}" />
                    <Rectangle
                        Width = "12"
                        Fill = "Transparent" />
                    <Button
                        Content = "Submit Form"
                        Command = "{Binding SubmitFormCommand}"
                        Style = "{StaticResource BtnAccent}" />
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
